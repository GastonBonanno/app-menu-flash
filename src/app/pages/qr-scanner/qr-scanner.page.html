<ion-header [hidden]="isScanActive">
  <ion-toolbar color="warning">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Menu Flash</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="{{isScanActive ? 'active-camera' : ''}}">

  <swiper-container #swiper>
    <!-- SLIDE 1 Qr Scanner -->
    <swiper-slide>
    </swiper-slide>

    <!-- SLIDE 2 Menú -->
    <swiper-slide>
      <ion-card-content class="banner">
        <ion-card-subtitle class="subtitle">{{menuResponse.header}}</ion-card-subtitle>
        <ion-card-title class="title">{{menuResponse.title}}</ion-card-title>
        <ion-text class="text">{{menuResponse.description}}</ion-text>
      </ion-card-content>

      <ion-list class="contenedor">
        <ion-item-group>

          <ion-grid [fixed]="true">


            <ion-row class="row-category" *ngFor="let category of menuResponse.listCategory">
              <ion-item-divider color="dark" class="title-gold">
                <ion-title class="title-category"> {{category.name}}</ion-title>
              </ion-item-divider>


              <ion-row (click)="setOpenModalItem(true, item)" *ngFor="let item of category.menuItems">

                <ion-col size="12" class="left-item-column">
                  <ion-row>
                    <ion-card-title>{{item.name}}</ion-card-title>
                  </ion-row>
                  <ion-row>
                    <ion-card-subtitle>{{item.description}}</ion-card-subtitle>
                  </ion-row>
                  <ion-row>
                    <ion-card-subtitle>$ {{item.price}}</ion-card-subtitle>
                  </ion-row>
                </ion-col>

              </ion-row>

            </ion-row>


          </ion-grid>

        </ion-item-group>
        <ion-col>
          <ion-row class="row">
            <ion-card-subtitle>Cantidad de items seleccionados: {{totalItems()}}</ion-card-subtitle>
          </ion-row>
        </ion-col>
        <ion-row class="buttons">
          <ion-col>
            <ion-button (click)="goToPreview()" color="warning"
                        shape="round">
              Ver pedido
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-list>

    </swiper-slide>

    <!-- SLIDE 3 Menu Preview-->
    <swiper-slide>
      <ion-list class="contenedor">
        <ion-item-group>

          <ion-grid [fixed]="true">


            <ion-row *ngFor="let item of orderItemList">
              <ion-col size="9">
                <ion-row>
                  <ion-card-title>{{item.itemName}}</ion-card-title>
                </ion-row>
                <ion-row>
                  <ion-card-subtitle>{{item.description}}</ion-card-subtitle>
                </ion-row>
                <ion-row>
                  <ion-card-subtitle>$ {{item.price}}</ion-card-subtitle>
                </ion-row>
                <ion-row>
                  <ion-card-subtitle>{{item.additionalComments}}</ion-card-subtitle>
                </ion-row>
                <ion-row>
                  <ion-card-subtitle>cantidad: {{item.quantity}}</ion-card-subtitle>
                </ion-row>
              </ion-col>
              <ion-col size="3">
                <ion-toolbar>
                <ion-fab color="white" (click)="removeItem(item)" slot="end" horizontal="end">
                  <ion-fab-button color="warning" size="small">
                    <ion-icon name="close-outline"></ion-icon>
                  </ion-fab-button>
                </ion-fab>
                </ion-toolbar>
              </ion-col>
            </ion-row>

          </ion-grid>

        </ion-item-group>
        <ion-col>
          <ion-row class="row">
            <ion-card-subtitle>Total: ${{totalToPay()}}</ion-card-subtitle>
          </ion-row>
        </ion-col>

        <ion-row class="buttons">
          <ion-col>
            <ion-button (click)="goToMenu()"
                        color="warning"
                        shape="round">
              Volver al menú
            </ion-button>
          </ion-col>
          <ion-col>
            <ion-button (click)="goToMercadopago()"
                        color="warning"
                        shape="round">
              Finalizar compra
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-list>

    </swiper-slide>

    <!-- Slide Mercadopago-->
    <swiper-slide>
      <ion-row class="pad">
      <ion-title class="title-gold pad">Medios de pago</ion-title>
      </ion-row>
      <div id="wallet_container"></div>

      <ion-row class="buttons">
        <ion-col>
          <ion-button (click)="goToMenu()"
                      color="warning"
                      shape="round">
            Volver al menú
          </ion-button>
        </ion-col>
      </ion-row>


    </swiper-slide>

  </swiper-container>




  <ion-modal (keydown.enter)="setOpenModalItem(false, undefined);" [isOpen]="isModalItemOpen"
             [backdropDismiss]="false">
    <ng-template>
      <ion-header>
        <ion-toolbar class="toolbar-color">
          <ion-title>Ítems del Menú</ion-title>
          <ion-fab (click)="setOpenModalItem(false,undefined); clearItem();" slot="end" horizontal="end">
            <ion-fab-button color="medium" size="small">
              <ion-icon name="close-outline"></ion-icon>
            </ion-fab-button>
          </ion-fab>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">

        <ion-grid class="grey-back">
          <ion-col>

            <ion-row>
              <ion-item-divider color="dark">
                <ion-title>Nombre</ion-title>
              </ion-item-divider>
              <ion-row style="margin-top: 10px">
                <ion-text>{{orderItem.itemName}}</ion-text>
              </ion-row>
            </ion-row>

            <ion-row style="margin-top: 25px">
              <ion-item-divider color="dark">
                <ion-title>Descripción</ion-title>
              </ion-item-divider>
              <ion-row style="margin-top: 10px">
                <ion-text>{{orderItem.description}}</ion-text>
              </ion-row>
            </ion-row>

            <ion-row style="margin-top: 25px">
              <ion-item-divider color="dark">
                <ion-title>Precio</ion-title>
              </ion-item-divider>
              <ion-row style="margin-top: 10px">
                <ion-text>{{"$ "+orderItem.price}}</ion-text>
              </ion-row>
            </ion-row>


            <ion-row style="margin-top: 20px; display: flex; justify-content: center; align-items: center;">

              <ion-col>
                <ion-item-divider color="dark">
                  <ion-text>Cantidad:</ion-text>
                </ion-item-divider>
              </ion-col>
              <ion-col style="display: flex; justify-content: center; align-items: center;">
                <ion-button (click)="removeOneOrderQuantity()" color="medium" size="small">
                  <ion-icon name="remove-outline"></ion-icon>
                </ion-button>
                <ion-text style="margin: 0 10px;">{{orderItem.quantity}}</ion-text>
                <ion-button (click)="addOneOrderQuantity()"  color="medium" size="small">
                  <ion-icon name="add-outline"></ion-icon>
                </ion-button>
              </ion-col>
            </ion-row>

            <ion-row style="margin-top: 20px">
              <ion-input placeholder="Comentarios adicionales" [(ngModel)]="orderItem.additionalComments"></ion-input>
            </ion-row>


          </ion-col>
        </ion-grid>
      </ion-content>
      <ion-footer>
        <ion-toolbar class="toolbar-color">
          <ion-buttons slot="end">
            <ion-button style="color: #1e1e1e" (click)="setOpenModalItem(false, undefined); addItemToOrderList(); clearItem();">Guardar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-footer>
    </ng-template>
  </ion-modal>




</ion-content>
